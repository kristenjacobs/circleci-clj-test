general:
  artifacts:
    - "target/uberjar/circleci-clj-test-0.1.0-SNAPSHOT-standalone.jar"
    - "target/coverage"

machine:
  services:
    - docker

test:
  override:
    - lein test2junit
    - lein uberjar
    - lein cloverage
    - docker build -t kristenfjacobs/circleci-clj-test .

deployment:
  deploy:
    commands:
      - echo "Deploying to staging environment"
      - docker run kristenfjacobs/circleci-clj-test
      - echo "Deploying to production environment"
      - docker run kristenfjacobs/circleci-clj-test
